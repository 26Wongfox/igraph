/* -*- mode: C -*-  */
/* 
   IGraph library.
   Copyright (C) 2006  Gabor Csardi <csardi@rmki.kfki.hu>
   MTA RMKI, Konkoly-Thege Miklos st. 29-33, Budapest 1121, Hungary
   
   This program is free software; you can redistribute it and/or modify
   it under the terms of the GNU General Public License as published by
   the Free Software Foundation; either version 2 of the License, or
   (at your option) any later version.
   
   This program is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   GNU General Public License for more details.
   
   You should have received a copy of the GNU General Public License
   along with this program; if not, write to the Free Software
   Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.

*/

#include "igraph.h"

unsigned int igraph_i_isoclass_3[] = {  0, 1, 1, 3, 1, 5, 6, 7,
					 1, 6,10,11, 3, 7,11,15,
					 1, 6, 5, 7,10,21,21,23,
					 6,25,21,27,11,27,30,31,
					 1,10, 6,11, 6,21,25,27,
					 5,21,21,30, 7,23,27,31,
					 3,11, 7,15,11,30,27,31,
					 7,27,23,31,15,31,31,63 };

unsigned int igraph_i_isoclass_3_idx[] = { 0, 4, 16, 1, 0, 32, 2, 8, 0 };

unsigned int igraph_i_isoclass_4[] = { 
     0,   1,   1,   3,   1,   3,   3,   7,   1,   9,  10,  11,  10,
    11,  14,  15,   1,  10,  18,  19,  20,  21,  22,  23,   3,  11,
    19,  27,  21,  29,  30,  31,   1,  10,  20,  21,  18,  19,  22,
    23,   3,  11,  21,  29,  19,  27,  30,  31,   3,  14,  22,  30,
    22,  30,  54,  55,   7,  15,  23,  31,  23,  31,  55,  63,   1,
    10,   9,  11,  10,  14,  11,  15,  18,  73,  73,  75,  76,  77,
    77,  79,  10,  81,  73,  83,  84,  85,  86,  87,  19,  83,  90,
    91,  92,  93,  94,  95,  20,  84,  98,  99, 100, 101, 102, 103,
    22,  86, 106, 107, 108, 109, 110, 111,  21,  85, 106, 115, 116,
   117, 118, 119,  23,  87, 122, 123, 124, 125, 126, 127,   1,  18,
    10,  19,  20,  22,  21,  23,  10,  73,  81,  83,  84,  86,  85,
    87,   9,  73,  73,  90,  98, 106, 106, 122,  11,  75,  83,  91,
    99, 107, 115, 123,  10,  76,  84,  92, 100, 108, 116, 124,  14,
    77,  85,  93, 101, 109, 117, 125,  11,  77,  86,  94, 102, 110,
   118, 126,  15,  79,  87,  95, 103, 111, 119, 127,   3,  19,  11,
    27,  21,  30,  29,  31,  19,  90,  83,  91,  92,  94,  93,  95,
    11,  83,  75,  91,  99, 115, 107, 123,  27,  91,  91, 219, 220,
   221, 221, 223,  21,  92,  99, 220, 228, 229, 230, 231,  30,  94,
   115, 221, 229, 237, 238, 239,  29,  93, 107, 221, 230, 238, 246,
   247,  31,  95, 123, 223, 231, 239, 247, 255,   1,  20,  10,  21,
    18,  22,  19,  23,  20,  98,  84,  99, 100, 102, 101, 103,  10,
    84,  76,  92, 100, 116, 108, 124,  21,  99,  92, 220, 228, 230,
   229, 231,  18, 100, 100, 228, 292, 293, 293, 295,  22, 102, 116,
   230, 293, 301, 302, 303,  19, 101, 108, 229, 293, 302, 310, 311,
    23, 103, 124, 231, 295, 303, 311, 319,   3,  21,  11,  29,  19,
    30,  27,  31,  22, 106,  86, 107, 108, 110, 109, 111,  14,  85,
    77,  93, 101, 117, 109, 125,  30, 115,  94, 221, 229, 238, 237,
   239,  22, 116, 102, 230, 293, 302, 301, 303,  54, 118, 118, 246,
   310, 365, 365, 367,  30, 117, 110, 238, 302, 373, 365, 375,  55,
   119, 126, 247, 311, 375, 382, 383,   3,  22,  14,  30,  22,  54,
    30,  55,  21, 106,  85, 115, 116, 118, 117, 119,  11,  86,  77,
    94, 102, 118, 110, 126,  29, 107,  93, 221, 230, 246, 238, 247,
    19, 108, 101, 229, 293, 310, 302, 311,  30, 110, 117, 238, 302,
   365, 373, 375,  27, 109, 109, 237, 301, 365, 365, 382,  31, 111,
   125, 239, 303, 367, 375, 383,   7,  23,  15,  31,  23,  55,  31,
    63,  23, 122,  87, 123, 124, 126, 125, 127,  15,  87,  79,  95,
   103, 119, 111, 127,  31, 123,  95, 223, 231, 247, 239, 255,  23,
   124, 103, 231, 295, 311, 303, 319,  55, 126, 119, 247, 311, 382,
   375, 383,  31, 125, 111, 239, 303, 375, 367, 383,  63, 127, 127,
   255, 319, 383, 383, 511,   1,  10,  10,  14,   9,  11,  11,  15,
    18,  73,  76,  77,  73,  75,  77,  79,  20,  84, 100, 101,  98,
    99, 102, 103,  22,  86, 108, 109, 106, 107, 110, 111,  10,  81,
    84,  85,  73,  83,  86,  87,  19,  83,  92,  93,  90,  91,  94,
    95,  21,  85, 116, 117, 106, 115, 118, 119,  23,  87, 124, 125,
   122, 123, 126, 127,  18,  76,  73,  77,  73,  77,  75,  79, 292,
   585, 585, 587, 585, 587, 587, 591, 100, 593, 594, 595, 596, 597,
   598, 599, 293, 601, 602, 603, 604, 605, 606, 607, 100, 593, 596,
   597, 594, 595, 598, 599, 293, 601, 604, 605, 602, 603, 606, 607,
   228, 625, 626, 627, 626, 627, 630, 631, 295, 633, 634, 635, 634,
   635, 638, 639,  20, 100,  84, 101,  98, 102,  99, 103, 100, 594,
   593, 595, 596, 598, 597, 599,  98, 596, 596, 659, 660, 661, 661,
   663, 102, 598, 666, 667, 661, 669, 670, 671,  84, 593, 674, 675,
   596, 666, 678, 679, 101, 595, 675, 683, 659, 667, 686, 687,  99,
   597, 678, 686, 661, 670, 694, 695, 103, 599, 679, 687, 663, 671,
   695, 703,  22, 108,  86, 109, 106, 110, 107, 111, 293, 602, 601,
   603, 604, 606, 605, 607, 102, 666, 598, 667, 661, 670, 669, 671,
   301, 729, 729, 731, 732, 733, 733, 735, 116, 737, 678, 739, 626,
   741, 742, 743, 302, 745, 746, 747, 748, 749, 750, 751, 230, 753,
   742, 755, 756, 757, 758, 759, 303, 761, 762, 763, 764, 765, 766,
   767,  10,  84,  81,  85,  73,  86,  83,  87, 100, 596, 593, 597,
   594, 598, 595, 599,  84, 674, 593, 675, 596, 678, 666, 679, 116,
   678, 737, 739, 626, 742, 741, 743,  76, 593, 593, 625, 585, 601,
   601, 633, 108, 666, 737, 753, 602, 729, 745, 761,  92, 675, 737,
   819, 604, 746, 822, 823, 124, 679, 826, 827, 634, 762, 830, 831,
    19,  92,  83,  93,  90,  94,  91,  95, 293, 604, 601, 605, 602,
   606, 603, 607, 101, 675, 595, 683, 659, 686, 667, 687, 302, 746,
   745, 747, 748, 750, 749, 751, 108, 737, 666, 753, 602, 745, 729,
   761, 310, 822, 822, 875, 876, 877, 877, 879, 229, 819, 741, 883,
   748, 885, 886, 887, 311, 823, 830, 891, 892, 893, 894, 895,  21,
   116,  85, 117, 106, 118, 115, 119, 228, 626, 625, 627, 626, 630,
   627, 631,  99, 678, 597, 686, 661, 694, 670, 695, 230, 742, 753,
   755, 756, 758, 757, 759,  92, 737, 675, 819, 604, 822, 746, 823,
   229, 741, 819, 883, 748, 886, 885, 887, 220, 739, 739, 947, 732,
   949, 949, 951, 231, 743, 827, 955, 764, 957, 958, 959,  23, 124,
    87, 125, 122, 126, 123, 127, 295, 634, 633, 635, 634, 638, 635,
   639, 103, 679, 599, 687, 663, 695, 671, 703, 303, 762, 761, 763,
   764, 766, 765, 767, 124, 826, 679, 827, 634, 830, 762, 831, 311,
   830, 823, 891, 892, 894, 893, 895, 231, 827, 743, 955, 764, 958,
   957, 959, 319, 831, 831,1019,1020,1021,1021,1023,   1,  18,  20,
    22,  10,  19,  21,  23,  10,  73,  84,  86,  81,  83,  85,  87,
    10,  76, 100, 108,  84,  92, 116, 124,  14,  77, 101, 109,  85,
    93, 117, 125,   9,  73,  98, 106,  73,  90, 106, 122,  11,  75,
    99, 107,  83,  91, 115, 123,  11,  77, 102, 110,  86,  94, 118,
   126,  15,  79, 103, 111,  87,  95, 119, 127,  20, 100,  98, 102,
    84, 101,  99, 103, 100, 594, 596, 598, 593, 595, 597, 599,  84,
   593, 596, 666, 674, 675, 678, 679, 101, 595, 659, 667, 675, 683,
   686, 687,  98, 596, 660, 661, 596, 659, 661, 663, 102, 598, 661,
   669, 666, 667, 670, 671,  99, 597, 661, 670, 678, 686, 694, 695,
   103, 599, 663, 671, 679, 687, 695, 703,  18, 292, 100, 293, 100,
   293, 228, 295,  76, 585, 593, 601, 593, 601, 625, 633,  73, 585,
   594, 602, 596, 604, 626, 634,  77, 587, 595, 603, 597, 605, 627,
   635,  73, 585, 596, 604, 594, 602, 626, 634,  77, 587, 597, 605,
   595, 603, 627, 635,  75, 587, 598, 606, 598, 606, 630, 638,  79,
   591, 599, 607, 599, 607, 631, 639,  22, 293, 102, 301, 116, 302,
   230, 303, 108, 602, 666, 729, 737, 745, 753, 761,  86, 601, 598,
   729, 678, 746, 742, 762, 109, 603, 667, 731, 739, 747, 755, 763,
   106, 604, 661, 732, 626, 748, 756, 764, 110, 606, 670, 733, 741,
   749, 757, 765, 107, 605, 669, 733, 742, 750, 758, 766, 111, 607,
   671, 735, 743, 751, 759, 767,  10, 100,  84, 116,  76, 108,  92,
   124,  84, 596, 674, 678, 593, 666, 675, 679,  81, 593, 593, 737,
   593, 737, 737, 826,  85, 597, 675, 739, 625, 753, 819, 827,  73,
   594, 596, 626, 585, 602, 604, 634,  86, 598, 678, 742, 601, 729,
   746, 762,  83, 595, 666, 741, 601, 745, 822, 830,  87, 599, 679,
   743, 633, 761, 823, 831,  21, 228,  99, 230,  92, 229, 220, 231,
   116, 626, 678, 742, 737, 741, 739, 743,  85, 625, 597, 753, 675,
   819, 739, 827, 117, 627, 686, 755, 819, 883, 947, 955, 106, 626,
   661, 756, 604, 748, 732, 764, 118, 630, 694, 758, 822, 886, 949,
   957, 115, 627, 670, 757, 746, 885, 949, 958, 119, 631, 695, 759,
   823, 887, 951, 959,  19, 293, 101, 302, 108, 310, 229, 311,  92,
   604, 675, 746, 737, 822, 819, 823,  83, 601, 595, 745, 666, 822,
   741, 830,  93, 605, 683, 747, 753, 875, 883, 891,  90, 602, 659,
   748, 602, 876, 748, 892,  94, 606, 686, 750, 745, 877, 885, 893,
    91, 603, 667, 749, 729, 877, 886, 894,  95, 607, 687, 751, 761,
   879, 887, 895,  23, 295, 103, 303, 124, 311, 231, 319, 124, 634,
   679, 762, 826, 830, 827, 831,  87, 633, 599, 761, 679, 823, 743,
   831, 125, 635, 687, 763, 827, 891, 955,1019, 122, 634, 663, 764,
   634, 892, 764,1020, 126, 638, 695, 766, 830, 894, 958,1021, 123,
   635, 671, 765, 762, 893, 957,1021, 127, 639, 703, 767, 831, 895,
   959,1023,   3,  19,  21,  30,  11,  27,  29,  31,  19,  90,  92,
    94,  83,  91,  93,  95,  21,  92, 228, 229,  99, 220, 230, 231,
    30,  94, 229, 237, 115, 221, 238, 239,  11,  83,  99, 115,  75,
    91, 107, 123,  27,  91, 220, 221,  91, 219, 221, 223,  29,  93,
   230, 238, 107, 221, 246, 247,  31,  95, 231, 239, 123, 223, 247,
   255,  22, 108, 106, 110,  86, 109, 107, 111, 293, 602, 604, 606,
   601, 603, 605, 607, 116, 737, 626, 741, 678, 739, 742, 743, 302,
   745, 748, 749, 746, 747, 750, 751, 102, 666, 661, 670, 598, 667,
   669, 671, 301, 729, 732, 733, 729, 731, 733, 735, 230, 753, 756,
   757, 742, 755, 758, 759, 303, 761, 764, 765, 762, 763, 766, 767,
    22, 293, 116, 302, 102, 301, 230, 303, 108, 602, 737, 745, 666,
   729, 753, 761, 106, 604, 626, 748, 661, 732, 756, 764, 110, 606,
   741, 749, 670, 733, 757, 765,  86, 601, 678, 746, 598, 729, 742,
   762, 109, 603, 739, 747, 667, 731, 755, 763, 107, 605, 742, 750,
   669, 733, 758, 766, 111, 607, 743, 751, 671, 735, 759, 767,  54,
   310, 118, 365, 118, 365, 246, 367, 310, 876, 822, 877, 822, 877,
   875, 879, 118, 822, 630, 886, 694, 949, 758, 957, 365, 877, 886,
  1755, 949,1757,1758,1759, 118, 822, 694, 949, 630, 886, 758, 957,
   365, 877, 949,1757, 886,1755,1758,1759, 246, 875, 758,1758, 758,
  1758,1782,1783, 367, 879, 957,1759, 957,1759,1783,1791,  14, 101,
    85, 117,  77, 109,  93, 125, 101, 659, 675, 686, 595, 667, 683,
   687,  85, 675, 625, 819, 597, 739, 753, 827, 117, 686, 819, 947,
   627, 755, 883, 955,  77, 595, 597, 627, 587, 603, 605, 635, 109,
   667, 739, 755, 603, 731, 747, 763,  93, 683, 753, 883, 605, 747,
   875, 891, 125, 687, 827, 955, 635, 763, 891,1019,  30, 229, 115,
   238,  94, 237, 221, 239, 302, 748, 746, 750, 745, 749, 747, 751,
   117, 819, 627, 883, 686, 947, 755, 955, 373, 885, 885,1883, 885,
  1883,1883,1887, 110, 741, 670, 757, 606, 749, 733, 765, 365, 886,
   949,1758, 877,1755,1757,1759, 238, 883, 757,1907, 750,1883,1758,
  1911, 375, 887, 958,1911, 893,1917,1918,1919,  30, 302, 117, 373,
   110, 365, 238, 375, 229, 748, 819, 885, 741, 886, 883, 887, 115,
   746, 627, 885, 670, 949, 757, 958, 238, 750, 883,1883, 757,1758,
  1907,1911,  94, 745, 686, 885, 606, 877, 750, 893, 237, 749, 947,
  1883, 749,1755,1883,1917, 221, 747, 755,1883, 733,1757,1758,1918,
   239, 751, 955,1887, 765,1759,1911,1919,  55, 311, 119, 375, 126,
   382, 247, 383, 311, 892, 823, 893, 830, 894, 891, 895, 119, 823,
   631, 887, 695, 951, 759, 959, 375, 893, 887,1917, 958,1918,1911,
  1919, 126, 830, 695, 958, 638, 894, 766,1021, 382, 894, 951,1918,
   894,2029,1918,2031, 247, 891, 759,1911, 766,1918,1783,2039, 383,
   895, 959,1919,1021,2031,2039,2047,   1,  20,  18,  22,  10,  21,
    19,  23,  20,  98, 100, 102,  84,  99, 101, 103,  18, 100, 292,
   293, 100, 228, 293, 295,  22, 102, 293, 301, 116, 230, 302, 303,
    10,  84, 100, 116,  76,  92, 108, 124,  21,  99, 228, 230,  92,
   220, 229, 231,  19, 101, 293, 302, 108, 229, 310, 311,  23, 103,
   295, 303, 124, 231, 311, 319,  10,  84,  73,  86,  81,  85,  83,
    87, 100, 596, 594, 598, 593, 597, 595, 599,  76, 593, 585, 601,
   593, 625, 601, 633, 108, 666, 602, 729, 737, 753, 745, 761,  84,
   674, 596, 678, 593, 675, 666, 679, 116, 678, 626, 742, 737, 739,
   741, 743,  92, 675, 604, 746, 737, 819, 822, 823, 124, 679, 634,
   762, 826, 827, 830, 831,  10, 100,  76, 108,  84, 116,  92, 124,
    84, 596, 593, 666, 674, 678, 675, 679,  73, 594, 585, 602, 596,
   626, 604, 634,  86, 598, 601, 729, 678, 742, 746, 762,  81, 593,
   593, 737, 593, 737, 737, 826,  85, 597, 625, 753, 675, 739, 819,
   827,  83, 595, 601, 745, 666, 741, 822, 830,  87, 599, 633, 761,
   679, 743, 823, 831,  14, 101,  77, 109,  85, 117,  93, 125, 101,
   659, 595, 667, 675, 686, 683, 687,  77, 595, 587, 603, 597, 627,
   605, 635, 109, 667, 603, 731, 739, 755, 747, 763,  85, 675, 597,
   739, 625, 819, 753, 827, 117, 686, 627, 755, 819, 947, 883, 955,
    93, 683, 605, 747, 753, 883, 875, 891, 125, 687, 635, 763, 827,
   955, 891,1019,   9,  98,  73, 106,  73, 106,  90, 122,  98, 660,
   596, 661, 596, 661, 659, 663,  73, 596, 585, 604, 594, 626, 602,
   634, 106, 661, 604, 732, 626, 756, 748, 764,  73, 596, 594, 626,
   585, 604, 602, 634, 106, 661, 626, 756, 604, 732, 748, 764,  90,
   659, 602, 748, 602, 748, 876, 892, 122, 663, 634, 764, 634, 764,
   892,1020,  11,  99,  75, 107,  83, 115,  91, 123, 102, 661, 598,
   669, 666, 670, 667, 671,  77, 597, 587, 605, 595, 627, 603, 635,
   110, 670, 606, 733, 741, 757, 749, 765,  86, 678, 598, 742, 601,
   746, 729, 762, 118, 694, 630, 758, 822, 949, 886, 957,  94, 686,
   606, 750, 745, 885, 877, 893, 126, 695, 638, 766, 830, 958, 894,
  1021,  11, 102,  77, 110,  86, 118,  94, 126,  99, 661, 597, 670,
   678, 694, 686, 695,  75, 598, 587, 606, 598, 630, 606, 638, 107,
   669, 605, 733, 742, 758, 750, 766,  83, 666, 595, 741, 601, 822,
   745, 830, 115, 670, 627, 757, 746, 949, 885, 958,  91, 667, 603,
   749, 729, 886, 877, 894, 123, 671, 635, 765, 762, 957, 893,1021,
    15, 103,  79, 111,  87, 119,  95, 127, 103, 663, 599, 671, 679,
   695, 687, 703,  79, 599, 591, 607, 599, 631, 607, 639, 111, 671,
   607, 735, 743, 759, 751, 767,  87, 679, 599, 743, 633, 823, 761,
   831, 119, 695, 631, 759, 823, 951, 887, 959,  95, 687, 607, 751,
   761, 887, 879, 895, 127, 703, 639, 767, 831, 959, 895,1023,   3,
    21,  19,  30,  11,  29,  27,  31,  22, 106, 108, 110,  86, 107,
   109, 111,  22, 116, 293, 302, 102, 230, 301, 303,  54, 118, 310,
   365, 118, 246, 365, 367,  14,  85, 101, 117,  77,  93, 109, 125,
    30, 115, 229, 238,  94, 221, 237, 239,  30, 117, 302, 373, 110,
   238, 365, 375,  55, 119, 311, 375, 126, 247, 382, 383,  19,  92,
    90,  94,  83,  93,  91,  95, 293, 604, 602, 606, 601, 605, 603,
   607, 108, 737, 602, 745, 666, 753, 729, 761, 310, 822, 876, 877,
   822, 875, 877, 879, 101, 675, 659, 686, 595, 683, 667, 687, 302,
   746, 748, 750, 745, 747, 749, 751, 229, 819, 748, 885, 741, 883,
   886, 887, 311, 823, 892, 893, 830, 891, 894, 895,  21, 228,  92,
   229,  99, 230, 220, 231, 116, 626, 737, 741, 678, 742, 739, 743,
   106, 626, 604, 748, 661, 756, 732, 764, 118, 630, 822, 886, 694,
   758, 949, 957,  85, 625, 675, 819, 597, 753, 739, 827, 117, 627,
   819, 883, 686, 755, 947, 955, 115, 627, 746, 885, 670, 757, 949,
   958, 119, 631, 823, 887, 695, 759, 951, 959,  30, 229,  94, 237,
   115, 238, 221, 239, 302, 748, 745, 749, 746, 750, 747, 751, 110,
   741, 606, 749, 670, 757, 733, 765, 365, 886, 877,1755, 949,1758,
  1757,1759, 117, 819, 686, 947, 627, 883, 755, 955, 373, 885, 885,
  1883, 885,1883,1883,1887, 238, 883, 750,1883, 757,1907,1758,1911,
   375, 887, 893,1917, 958,1911,1918,1919,  11,  99,  83, 115,  75,
   107,  91, 123, 102, 661, 666, 670, 598, 669, 667, 671,  86, 678,
   601, 746, 598, 742, 729, 762, 118, 694, 822, 949, 630, 758, 886,
   957,  77, 597, 595, 627, 587, 605, 603, 635, 110, 670, 741, 757,
   606, 733, 749, 765,  94, 686, 745, 885, 606, 750, 877, 893, 126,
   695, 830, 958, 638, 766, 894,1021,  27, 220,  91, 221,  91, 221,
   219, 223, 301, 732, 729, 733, 729, 733, 731, 735, 109, 739, 603,
   747, 667, 755, 731, 763, 365, 949, 877,1757, 886,1758,1755,1759,
   109, 739, 667, 755, 603, 747, 731, 763, 365, 949, 886,1758, 877,
  1757,1755,1759, 237, 947, 749,1883, 749,1883,1755,1917, 382, 951,
   894,1918, 894,1918,2029,2031,  29, 230,  93, 238, 107, 246, 221,
   247, 230, 756, 753, 757, 742, 758, 755, 759, 107, 742, 605, 750,
   669, 758, 733, 766, 246, 758, 875,1758, 758,1782,1758,1783,  93,
   753, 683, 883, 605, 875, 747, 891, 238, 757, 883,1907, 750,1758,
  1883,1911, 221, 755, 747,1883, 733,1758,1757,1918, 247, 759, 891,
  1911, 766,1783,1918,2039,  31, 231,  95, 239, 123, 247, 223, 255,
   303, 764, 761, 765, 762, 766, 763, 767, 111, 743, 607, 751, 671,
   759, 735, 767, 367, 957, 879,1759, 957,1783,1759,1791, 125, 827,
   687, 955, 635, 891, 763,1019, 375, 958, 887,1911, 893,1918,1917,
  1919, 239, 955, 751,1887, 765,1911,1759,1919, 383, 959, 895,1919,
  1021,2039,2031,2047,   3,  22,  22,  54,  14,  30,  30,  55,  21,
   106, 116, 118,  85, 115, 117, 119,  19, 108, 293, 310, 101, 229,
   302, 311,  30, 110, 302, 365, 117, 238, 373, 375,  11,  86, 102,
   118,  77,  94, 110, 126,  29, 107, 230, 246,  93, 221, 238, 247,
    27, 109, 301, 365, 109, 237, 365, 382,  31, 111, 303, 367, 125,
   239, 375, 383,  21, 116, 106, 118,  85, 117, 115, 119, 228, 626,
   626, 630, 625, 627, 627, 631,  92, 737, 604, 822, 675, 819, 746,
   823, 229, 741, 748, 886, 819, 883, 885, 887,  99, 678, 661, 694,
   597, 686, 670, 695, 230, 742, 756, 758, 753, 755, 757, 759, 220,
   739, 732, 949, 739, 947, 949, 951, 231, 743, 764, 957, 827, 955,
   958, 959,  19, 293, 108, 310, 101, 302, 229, 311,  92, 604, 737,
   822, 675, 746, 819, 823,  90, 602, 602, 876, 659, 748, 748, 892,
    94, 606, 745, 877, 686, 750, 885, 893,  83, 601, 666, 822, 595,
   745, 741, 830,  93, 605, 753, 875, 683, 747, 883, 891,  91, 603,
   729, 877, 667, 749, 886, 894,  95, 607, 761, 879, 687, 751, 887,
   895,  30, 302, 110, 365, 117, 373, 238, 375, 229, 748, 741, 886,
   819, 885, 883, 887,  94, 745, 606, 877, 686, 885, 750, 893, 237,
   749, 749,1755, 947,1883,1883,1917, 115, 746, 670, 949, 627, 885,
   757, 958, 238, 750, 757,1758, 883,1883,1907,1911, 221, 747, 733,
  1757, 755,1883,1758,1918, 239, 751, 765,1759, 955,1887,1911,1919,
    11, 102,  86, 118,  77, 110,  94, 126,  99, 661, 678, 694, 597,
   670, 686, 695,  83, 666, 601, 822, 595, 741, 745, 830, 115, 670,
   746, 949, 627, 757, 885, 958,  75, 598, 598, 630, 587, 606, 606,
   638, 107, 669, 742, 758, 605, 733, 750, 766,  91, 667, 729, 886,
   603, 749, 877, 894, 123, 671, 762, 957, 635, 765, 893,1021,  29,
   230, 107, 246,  93, 238, 221, 247, 230, 756, 742, 758, 753, 757,
   755, 759,  93, 753, 605, 875, 683, 883, 747, 891, 238, 757, 750,
  1758, 883,1907,1883,1911, 107, 742, 669, 758, 605, 750, 733, 766,
   246, 758, 758,1782, 875,1758,1758,1783, 221, 755, 733,1758, 747,
  1883,1757,1918, 247, 759, 766,1783, 891,1911,1918,2039,  27, 301,
   109, 365, 109, 365, 237, 382, 220, 732, 739, 949, 739, 949, 947,
   951,  91, 729, 603, 877, 667, 886, 749, 894, 221, 733, 747,1757,
   755,1758,1883,1918,  91, 729, 667, 886, 603, 877, 749, 894, 221,
   733, 755,1758, 747,1757,1883,1918, 219, 731, 731,1755, 731,1755,
  1755,2029, 223, 735, 763,1759, 763,1759,1917,2031,  31, 303, 111,
   367, 125, 375, 239, 383, 231, 764, 743, 957, 827, 958, 955, 959,
    95, 761, 607, 879, 687, 887, 751, 895, 239, 765, 751,1759, 955,
  1911,1887,1919, 123, 762, 671, 957, 635, 893, 765,1021, 247, 766,
   759,1783, 891,1918,1911,2039, 223, 763, 735,1759, 763,1917,1759,
  2031, 255, 767, 767,1791,1019,1919,1919,2047,   7,  23,  23,  55,
    15,  31,  31,  63,  23, 122, 124, 126,  87, 123, 125, 127,  23,
   124, 295, 311, 103, 231, 303, 319,  55, 126, 311, 382, 119, 247,
   375, 383,  15,  87, 103, 119,  79,  95, 111, 127,  31, 123, 231,
   247,  95, 223, 239, 255,  31, 125, 303, 375, 111, 239, 367, 383,
    63, 127, 319, 383, 127, 255, 383, 511,  23, 124, 122, 126,  87,
   125, 123, 127, 295, 634, 634, 638, 633, 635, 635, 639, 124, 826,
   634, 830, 679, 827, 762, 831, 311, 830, 892, 894, 823, 891, 893,
   895, 103, 679, 663, 695, 599, 687, 671, 703, 303, 762, 764, 766,
   761, 763, 765, 767, 231, 827, 764, 958, 743, 955, 957, 959, 319,
   831,1020,1021, 831,1019,1021,1023,  23, 295, 124, 311, 103, 303,
   231, 319, 124, 634, 826, 830, 679, 762, 827, 831, 122, 634, 634,
   892, 663, 764, 764,1020, 126, 638, 830, 894, 695, 766, 958,1021,
    87, 633, 679, 823, 599, 761, 743, 831, 125, 635, 827, 891, 687,
   763, 955,1019, 123, 635, 762, 893, 671, 765, 957,1021, 127, 639,
   831, 895, 703, 767, 959,1023,  55, 311, 126, 382, 119, 375, 247,
   383, 311, 892, 830, 894, 823, 893, 891, 895, 126, 830, 638, 894,
   695, 958, 766,1021, 382, 894, 894,2029, 951,1918,1918,2031, 119,
   823, 695, 951, 631, 887, 759, 959, 375, 893, 958,1918, 887,1917,
  1911,1919, 247, 891, 766,1918, 759,1911,1783,2039, 383, 895,1021,
  2031, 959,1919,2039,2047,  15, 103,  87, 119,  79, 111,  95, 127,
   103, 663, 679, 695, 599, 671, 687, 703,  87, 679, 633, 823, 599,
   743, 761, 831, 119, 695, 823, 951, 631, 759, 887, 959,  79, 599,
   599, 631, 591, 607, 607, 639, 111, 671, 743, 759, 607, 735, 751,
   767,  95, 687, 761, 887, 607, 751, 879, 895, 127, 703, 831, 959,
   639, 767, 895,1023,  31, 231, 123, 247,  95, 239, 223, 255, 303,
   764, 762, 766, 761, 765, 763, 767, 125, 827, 635, 891, 687, 955,
   763,1019, 375, 958, 893,1918, 887,1911,1917,1919, 111, 743, 671,
   759, 607, 751, 735, 767, 367, 957, 957,1783, 879,1759,1759,1791,
   239, 955, 765,1911, 751,1887,1759,1919, 383, 959,1021,2039, 895,
  1919,2031,2047,  31, 303, 125, 375, 111, 367, 239, 383, 231, 764,
   827, 958, 743, 957, 955, 959, 123, 762, 635, 893, 671, 957, 765,
  1021, 247, 766, 891,1918, 759,1783,1911,2039,  95, 761, 687, 887,
   607, 879, 751, 895, 239, 765, 955,1911, 751,1759,1887,1919, 223,
   763, 763,1917, 735,1759,1759,2031, 255, 767,1019,1919, 767,1791,
  1919,2047,  63, 319, 127, 383, 127, 383, 255, 511, 319,1020, 831,
  1021, 831,1021,1019,1023, 127, 831, 639, 895, 703, 959, 767,1023,
   383,1021, 895,2031, 959,2039,1919,2047, 127, 831, 703, 959, 639,
   895, 767,1023, 383,1021, 959,2039, 895,2031,1919,2047, 255,1019,
   767,1919, 767,1919,1791,2047, 511,1023,1023,2047,1023,2047,2047,
  4095 };

unsigned int igraph_i_isoclass_4_idx[] = {
  0, 8, 64, 512, 1, 0, 128, 1024, 2, 16, 0, 2048, 4, 32, 256, 0 };

unsigned int igraph_i_isoclass_3u[] = { 0,1,1,3,1,3,3,7 };

unsigned int igraph_i_isoclass_3u_idx[] = { 0,1,2,1,0,4,2,4,0 };

unsigned int igraph_i_isoclass_4u[] = {
  0, 1, 1, 3, 1, 3, 3, 7, 1, 3, 3,11,12,13,13,15, 1, 3,12,13, 3,11,13,15, 3, 7,
 13,15,13,15,30,31, 1,12, 3,13, 3,13,11,15, 3,13, 7,15,13,30,15,31, 3,13,13,30,
  7,15,15,31,11,15,15,31,15,31,31,63 };

unsigned int igraph_i_isoclass_4u_idx[] = {
  0, 1, 2, 8, 1, 0, 4, 16, 2, 4, 0, 32, 8, 16, 32, 0 };

int igraph_isoclass(const igraph_t *graph, int *class) {
  long int e;
  long int no_of_nodes=igraph_vcount(graph);
  long int no_of_edges=igraph_ecount(graph);
  integer_t from, to;
  unsigned char idx, mul;
  unsigned int *arr_idx, *arr_code;
  int code=0;
  
  if (igraph_is_directed(graph)) {
    if (no_of_nodes==3) {
      arr_idx=igraph_i_isoclass_3_idx;
      arr_code=igraph_i_isoclass_3;
      mul=3;
    } else {
      arr_idx=igraph_i_isoclass_4_idx;
      arr_code=igraph_i_isoclass_4;
      mul=4;
    }      
  } else {
    if (no_of_nodes==3) {
      arr_idx=igraph_i_isoclass_3u_idx;
      arr_code=igraph_i_isoclass_3u;
      mul=3;
    } else {
      arr_idx=igraph_i_isoclass_4u_idx;
      arr_code=igraph_i_isoclass_4u;
      mul=4;
    }      
  }
  for (e=0; e<no_of_edges; e++) {
    igraph_edge(graph, e, &from, &to);
    idx=mul*from+to;
    code |= arr_idx[idx];
  }
  
  *class=arr_code[code];
  return 0;
}

int igraph_isomorphic(const igraph_t *graph1, const igraph_t *graph2,
		      bool_t *iso) {
  int class1, class2;
  IGRAPH_CHECK(igraph_isoclass(graph1, &class1));
  IGRAPH_CHECK(igraph_isoclass(graph2, &class2));
  *iso= (class1 == class2);
  return 0;
}

