
##################################
# GRAPH

GRAPH:
  CTYPE: igraph_t*
  JAVATYPE: jobject
  INCONV: 
    IN: if (Java_jobject_to_igraph(env, %I%, &%C%)) return 0;
    OUT: %C% = (igraph_t*)calloc(1, sizeof(igraph_t));
    INOUT: if (Java_jobject_to_igraph(env, %I%, &%C%)) return 0;
  OUTCONV:
    OUT: %J% = Java_igraph_to_new_jobject(env, %C%, cls);
    INOUT: /* No conversion needed for INOUT GRAPH */

##################################
# INTEGER

INTEGER:  
  CTYPE: igraph_integer_t
  JAVATYPE: jlong
  INCONV: 
    IN: %C% = (igraph_integer_t)%I%;
  OUTCONV:
    OUT: %J% = (jlong)%C%;

INTEGERPTR:
  CTYPE: igraph_integer_t
  JAVATYPE: jlong
  CALL: &%C%
  OUTCONV:
    OUT: %J% = (jlong)%C%;

INT:
  CTYPE: int
  JAVATYPE: jint
  INCONV:
    IN: %C% = (int)%I%;

##################################
# LONGINT

LONGINT:  
  CTYPE: long int
  JAVATYPE: jlong
  INCONV: 
    IN: %C% = (long int)%I%;
  OUTCONV:
    OUT: %J% = (jlong)%C%;

##################################
# REAL

REAL:
  CTYPE: igraph_real_t
  JAVATYPE: jdouble
  INCONV:
    IN: %C% = (igraph_real_t)%I%;
  OUTCONV:
    OUT: %J% = (jdouble)%C%;

REALPTR:
  CTYPE: igraph_real_t
  JAVATYPE: jdouble
  CALL: &%C%
  INCONV:
    INOUT: %C% = (igraph_real_t)%I%;
  OUTCONV:
    OUT: %J% = (jdouble)%C%;

##################################
# BOOLEAN

BOOLEAN:
  CTYPE: igraph_bool_t
  JAVATYPE: jboolean
  INCONV:
    IN: %C% = (igraph_bool_t)%I%;
  OUTCONV:
    OUT: %J% = (%C% ? JNI_TRUE : JNI_FALSE);

BOOLEANPTR:
  CTYPE: igraph_bool_t
  JAVATYPE: jboolean
  CALL: &%C%
  OUTCONV:
    OUT: %J% = (%C% ? JNI_TRUE : JNI_FALSE);

##################################
# ERROR, used as the return type usually

ERROR:
  CTYPE: int
  JAVATYPE: void
  JAVADECL: /* no Java return value declaration */
  OUTCONV:
    OUT:    /* not returning anything */

##################################
# ATTRIBUTES (not implemented yet)

ATTRIBUTES:
  JAVATYPE: jobject
  CTYPE: void*
  INCONV:
    IN: %C% = 0;

##################################
# ENUMS

ADJACENCYMODE:
  CTYPE: igraph_adjacency_t
  JAVATYPE: jobject
  INCONV:
    IN: if (Java_net_sf_igraph_Adjacency_to_igraph(env, %I%, &%C%)) { \
	        IGRAPH_ERROR_NPE(); \
		}

CONNECTEDNESS:
  CTYPE: igraph_connectedness_t
  JAVATYPE: jobject
  INCONV:
    IN: if (Java_net_sf_igraph_Connectedness_to_igraph(env, %I%, &%C%)) { \
	        IGRAPH_ERROR_NPE(); \
		}

NEIMODE:
  CTYPE: igraph_neimode_t
  JAVATYPE: jobject
  INCONV:
    IN: if (Java_net_sf_igraph_NeighborMode_to_igraph(env, %I%, &%C%)) { \
	        IGRAPH_ERROR_NPE(); \
		}

STARMODE:
  CTYPE: igraph_star_mode_t
  JAVATYPE: jobject
  INCONV:
    IN: if (Java_net_sf_igraph_StarMode_to_igraph(env, %I%, &%C%)) { \
	        IGRAPH_ERROR_NPE(); \
		}

TRANSITIVITYMODE:
  CTYPE: igraph_transitivity_mode_t
  JAVATYPE: jobject
  INCONV:
    IN: if (Java_net_sf_igraph_TransitivityMode_to_igraph(env, %I%, &%C%)) { \
	        IGRAPH_ERROR_NPE(); \
		}

##################################
# VECTOR of real values

VECTOR:
  CTYPE: igraph_vector_t
  JAVATYPE: jdoubleArray
  CALL: &%C%
  INCONV:
    IN:  Java_jdoubleArray_to_igraph_vector(env, %I%, &%C%); \
	     IGRAPH_FINALLY(igraph_vector_destroy, &%C%);
    OUT: if (0 != igraph_vector_init(&%C%, 0)) { \
	       igraph_error("", __FILE__, __LINE__, IGRAPH_ENOMEM); \
		 } \
		 IGRAPH_FINALLY(igraph_vector_destroy, &%C%);
  OUTCONV:
    IN:  igraph_vector_destroy(&%C%); \
	     IGRAPH_FINALLY_CLEAN(1);
    OUT: %J% = Java_igraph_vector_to_new_jdoubleArray(env, &%C%); \
         igraph_vector_destroy(&%C%); \
         IGRAPH_FINALLY_CLEAN(1);

VECTORLIST:
  CTYPE: igraph_vector_ptr_t
  CALL: &%C%
  INCONV:
    OUT: if (0 != igraph_vector_ptr_init(&%C%, 0)) { \
           igraph_error("", __FILE__, __LINE__, IGRAPH_ENOMEM); \
         } \
         IGRAPH_FINALLY(R_igraph_vectorlist_destroy, &%C%);
  OUTCONV:
    OUT: PROTECT(%I%=R_igraph_vectorlist_to_SEXP(&%C%)); \
         R_igraph_vectorlist_destroy(&%C%); \
         IGRAPH_FINALLY_CLEAN(1);

##################################
# VECTOR that can be NULL

VECTOR_OR_0:
  CTYPE: igraph_vector_t
  JAVATYPE: jdoubleArray
  CALL: (%I% == 0 ? 0 : &%C%)
  INCONV:
    IN:  if (%I% != 0) { \
           Java_jdoubleArray_to_igraph_vector(env, %I%, &%C%); \
           IGRAPH_FINALLY(igraph_vector_destroy, &%C%); \
         }
  OUTCONV:
    IN:  if (%I% != 0) { \
           igraph_vector_destroy(&%C%); \
           IGRAPH_FINALLY_CLEAN(1); \
         }

# This is the same, some syntax would be needed to express it

EDGEWEIGHTS:
  CTYPE: igraph_vector_t
  JAVATYPE: jdoubleArray
  CALL: (%I% == 0 ? 0 : &%C%)
  INCONV:
    IN:  if (%I% != 0) { \
           Java_jdoubleArray_to_igraph_vector(env, %I%, &%C%); \
           IGRAPH_FINALLY(igraph_vector_destroy, &%C%); \
         }
  OUTCONV:
    IN:  if (%I% != 0) { \
           igraph_vector_destroy(&%C%); \
           IGRAPH_FINALLY_CLEAN(1); \
         }

##################################
# MATRIX of real values

MATRIX:
  CTYPE: igraph_matrix_t
  CALL: &%C%
  INCONV:
    IN: R_SEXP_to_matrix(%I%, &%C%);
    OUT: if (0 != igraph_matrix_init(&%C%, 0, 0)) { \
            igraph_error("", __FILE__, __LINE__, IGRAPH_ENOMEM); \
         } \
         IGRAPH_FINALLY(igraph_vector_destroy, &%C%);
  OUTCONV:
    OUT: PROTECT(%I%=R_igraph_matrix_to_SEXP(&%C%)); \
         igraph_matrix_destroy(&%C%); \
         IGRAPH_FINALLY_CLEAN(1);

##################################
# Some vertices of a graph

VERTEXSET:
  CTYPE: igraph_vs_t
  JAVATYPE: jobject
  INCONV:
    IN: if (0 != Java_net_sf_igraph_VertexSet_to_igraph_vs(env, %I%, &%C%)) { \
	      igraph_error("", __FILE__, __LINE__, IGRAPH_ENOMEM); \
		} \
	    IGRAPH_FINALLY(igraph_vs_destroy, &%C%);
  OUTCONV:
    IN: igraph_vs_destroy(&%C%); \
	    IGRAPH_FINALLY_CLEAN(1);

##################################
# Files

INFILE:
  CTYPE: FILE*
  JAVATYPE: jobject
  INCONV:
    IN: if (0 != Java_jobject_to_file_ptr(env, %I%, &%C%, "r")) { \
	      igraph_error("__java/io/IOException", __FILE__, __LINE__, IGRAPH_ENOMEM); \
		}
  OUTCONV:
    IN: fclose(%C%);

OUTFILE:
  CTYPE: FILE*
  JAVATYPE: jobject
  INCONV:
    IN: if (0 != Java_jobject_to_file_ptr(env, %I%, &%C%, "w")) { \
	      igraph_error("__java/io/IOException", __FILE__, __LINE__, IGRAPH_ENOMEM); \
		}
  OUTCONV:
    IN: fclose(%C%);

##################################
# NULL, this is supplied as an argument

NULL:
  CALL: 0
  HEADER:

##################################
# Options to the ARPACK solver

ARPACKOPT:
  CTYPE: igraph_arpack_options_t
  CALL: &%C%
  INCONV:
    INOUT: R_SEXP_to_igraph_arpack_options(%I%, &%C%);
  OUTCONV:
    INOUT: PROTECT(%I%=R_igraph_arpack_options_to_SEXP(&%C%));

